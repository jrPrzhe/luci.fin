# üöÄ –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

1. **–†–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** - –ø–æ–ª–µ `is_admin` –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - `ADMIN_TELEGRAM_IDS` –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è Telegram ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
3. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
   - `GET /api/v1/admin/users` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
   - `POST /api/v1/admin/users/{user_id}/reset` - —Å–±—Ä–æ—Å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **Frontend —Å—Ç—Ä–∞–Ω–∏—Ü–∞** - `/statistics` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìã –®–∞–≥–∏ –¥–ª—è –¥–µ–ø–ª–æ—è

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –∏–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Railway –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```env
ADMIN_TELEGRAM_IDS=123456789,987654321
```

–ò–ª–∏ —á–µ—Ä–µ–∑ JSON (–¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö ID):
```env
ADMIN_TELEGRAM_IDS=["123456789", "987654321"]
```

**–ö–∞–∫ —É–∑–Ω–∞—Ç—å Telegram ID:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ—Ç–∞ @userinfobot –≤ Telegram
- –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Telegram Mini App

### 2. –î–µ–ø–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –ß–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```bash
git add .
git commit -m "Add admin role and statistics page"
git push
```

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞–¥–µ–ø–ª–æ–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ü—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–æ–±–∞–≤–∏—Ç –∫–æ–ª–æ–Ω–∫—É `is_admin` –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç)
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å—ã

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:

–ö–æ–ª–æ–Ω–∫–∞ `is_admin` –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend —á–µ—Ä–µ–∑ —Ö–µ–ª–ø–µ—Ä –≤ `main.py`. 

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
```bash
railway run alembic upgrade head
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. **–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram Mini App** —Å Telegram ID –∏–∑ `ADMIN_TELEGRAM_IDS`
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –ü—Ä–æ—Ñ–∏–ª—å** ‚Üí –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** ‚Üí –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API**:
   - `GET /api/v1/admin/users` - –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –î–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤ –≤–µ—Ä–Ω–µ—Ç—Å—è 403 Forbidden

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∞–¥–º–∏–Ω–∞–º–∏:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Ö Telegram ID –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `ADMIN_TELEGRAM_IDS`
2. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Telegram Mini App —Å—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∞ –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –≤—Ä—É—á–Ω—É—é –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
   ```sql
   UPDATE users SET is_admin = 1 WHERE telegram_id = '123456789';
   ```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `is_admin = True` –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `/api/v1/admin/*`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `get_current_admin()` dependency
- ‚úÖ Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤

## üìä –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –≤–∏–¥—è—Ç:
- **–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å:
  - –ò–º–µ–Ω–µ–º –∏ Telegram username
  - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
  - –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞)
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, —Å—á–µ—Ç–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ –∑–∞–≤–æ–¥—Å–∫–∏—Ö

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞ - –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞, –¥–∞–Ω–Ω—ã–µ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—Ç `is_admin = False` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –°—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ Telegram

## üêõ Troubleshooting

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –≤–∏–∂—É –∫–Ω–æ–ø–∫—É "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à Telegram ID –≤ `ADMIN_TELEGRAM_IDS`
- –í—ã–π–¥–∏—Ç–µ –∏ –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ Telegram Mini App
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–∞–∑–µ: `SELECT is_admin FROM users WHERE telegram_id = 'YOUR_ID'`

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ 403 –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ `/api/v1/admin/users`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `is_admin = True` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–ª–æ–Ω–∫–∞ `is_admin` –Ω–µ —Å–æ–∑–¥–∞–ª–∞—Å—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "Added is_admin column to users table"
- –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é: `railway run alembic upgrade head`
- –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL: `ALTER TABLE users ADD COLUMN is_admin BOOLEAN DEFAULT 0;`

