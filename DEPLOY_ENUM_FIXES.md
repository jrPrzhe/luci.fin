# üöÄ –î–µ–ø–ª–æ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π enum –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ –ø—Ä–æ–¥–µ

## üìã –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–ú–æ–¥–µ–ª—å Category** - –¥–æ–±–∞–≤–ª–µ–Ω `TransactionTypeEnum` TypeDecorator –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å enum
2. **–ó–∞–ø—Ä–æ—Å—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `transaction_type` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º cast –∫ —Ç–µ–∫—Å—Ç—É
3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** - –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è `transaction_type` –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ lowercase
4. **TypeDecorator** - —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ uppercase, —Ç–∞–∫ –∏ lowercase –∑–Ω–∞—á–µ–Ω–∏–π enum

## üîÑ –®–∞–≥ 1: –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd finance-manager

# –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add backend/app/models/category.py
git add backend/app/models/transaction.py
git add backend/app/api/v1/categories.py
git add backend/app/api/v1/transactions.py

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git commit -m "Fix enum issues: Add TypeDecorator for Category, fix category queries and transaction creation"

# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ GitHub
git push origin main
```

## üöÇ –®–∞–≥ 2: –î–æ–∂–¥–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –≤ Railway

Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç push –≤ `main` –≤–µ—Ç–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –¥–µ–ø–ª–æ–π:
- –û–±—ã—á–Ω–æ —ç—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç 2-5 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ Railway Dashboard ‚Üí Deployments

## üîß –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–¥–µ

–ú–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ `main.py`), –Ω–æ –ª—É—á—à–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ö –≤—Ä—É—á–Ω—É—é –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏.

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Railway CLI (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Railway CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
npm i -g @railway/cli

# –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
railway login

# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –ø—Ä–æ–µ–∫—Ç—É
railway link

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
railway run python backend/run_migrations.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Railway Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Railway Dashboard](https://railway.app)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –û—Ç–∫—Ä–æ–π—Ç–µ **Backend Service**
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Deployments** ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π
5. –û—Ç–∫—Ä–æ–π—Ç–µ **Shell/Console** (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
6. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   cd backend
   python run_migrations.py
   ```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ß–µ—Ä–µ–∑ Railway CLI —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```bash
railway run --directory backend alembic upgrade head
```

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API endpoint

```bash
curl https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/check-migrations
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON —Å:
- `alembic_version`: `9fae3a73c9e6` (–ø–æ—Å–ª–µ–¥–Ω—è—è –º–∏–≥—Ä–∞—Ü–∏—è)
- `enum_values`: `['income', 'expense', 'transfer', 'both']` (–≤—Å–µ –≤ lowercase)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Railway CLI

```bash
railway run python backend/check_migrations.py
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ enum –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞–ø—Ä—è–º—É—é

```bash
railway run python -c "
from app.core.database import engine
from sqlalchemy import text
with engine.connect() as conn:
    result = conn.execute(text(\"\"\"
        SELECT enumlabel 
        FROM pg_enum 
        WHERE enumtypid = (SELECT oid FROM pg_type WHERE typname = 'transactiontype')
        ORDER BY enumsortorder
    \"\"\"))
    values = [row[0] for row in result]
    print('Enum values:', values)
    assert all(v.islower() for v in values), 'Enum values should be lowercase!'
    print('‚úÖ All enum values are lowercase')
"
```

## üß™ –®–∞–≥ 5: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞

```bash
curl -X POST https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/transactions/ \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù" \
  -H "Content-Type: application/json" \
  -d '{
    "account_id": 1,
    "transaction_type": "income",
    "amount": 100.0,
    "currency": "RUB"
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –±–µ–∑ –æ—à–∏–±–æ–∫ enum.

### –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞

```bash
curl -X POST https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/transactions/ \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù" \
  -H "Content-Type: application/json" \
  -d '{
    "account_id": 1,
    "transaction_type": "expense",
    "amount": 50.0,
    "currency": "RUB",
    "category_id": 1
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ.

### –¢–µ—Å—Ç 3: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤

```bash
curl https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/categories/?transaction_type=income \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤, –±–µ–∑ –æ—à–∏–±–æ–∫.

### –¢–µ—Å—Ç 4: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤

```bash
curl https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/categories/?transaction_type=expense \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤, –±–µ–∑ –æ—à–∏–±–æ–∫.

### –¢–µ—Å—Ç 5: –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∞

```bash
curl -X POST https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/transactions/ \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù" \
  -H "Content-Type: application/json" \
  -d '{
    "account_id": 1,
    "transaction_type": "transfer",
    "amount": 100.0,
    "currency": "RUB",
    "to_account_id": 2
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–µ—Ä–µ–≤–æ–¥ —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ, —Å–æ–∑–¥–∞–Ω—ã –¥–≤–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∏—Å—Ö–æ–¥—è—â–∞—è –∏ –≤—Ö–æ–¥—è—â–∞—è).

### –¢–µ—Å—Ç 6: –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–∫–∏ `'income' is not among the defined enum values`.

### –¢–µ—Å—Ç 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–æ–≤

```bash
curl https://–í–ê–®_–ë–≠–ö–ï–ù–î_URL/api/v1/reports/analytics?period=month \
  -H "Authorization: Bearer –í–ê–®_–¢–û–ö–ï–ù"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ç—á–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è.

## ‚ö†Ô∏è –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∏ –æ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é (—Å–º. –®–∞–≥ 3)

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "invalid input value for enum transactiontype: 'INCOME'"

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ `check_migrations.py`)
2. –ï—Å–ª–∏ enum –≤—Å–µ –µ—â–µ –≤ uppercase, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é:
   ```bash
   railway run python backend/run_migrations.py
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Railway - —Ç–∞–º –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ –æ—à–∏–±–∫–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—à–∏–±–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ enum –∑–Ω–∞—á–µ–Ω–∏—è –≤ lowercase

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ GitHub
- [ ] Railway —É—Å–ø–µ—à–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏–ª (–∑–µ–ª–µ–Ω—ã–π —Å—Ç–∞—Ç—É—Å)
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ `check_migrations.py`)
- [ ] Enum –∑–Ω–∞—á–µ–Ω–∏—è –≤ lowercase (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ —á–µ—Ä–µ–∑ SQL)
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–µ—Ä–µ–≤–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –û—Ç—á–µ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ

## üéØ –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

```bash
# 1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
cd finance-manager
git add backend/app/models/category.py backend/app/models/transaction.py backend/app/api/v1/categories.py backend/app/api/v1/transactions.py
git commit -m "Fix enum issues: Add TypeDecorator for Category, fix category queries and transaction creation"
git push origin main

# 2. –ü–æ–¥–æ–∂–¥–∞—Ç—å 2-5 –º–∏–Ω—É—Ç –ø–æ–∫–∞ Railway –∑–∞–¥–µ–ø–ª–æ–∏—Ç

# 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
railway run python backend/run_migrations.py

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
railway run python backend/check_migrations.py
```

---

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ Railway –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç backend, –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.





